(function(g){function v(a,c){var b=g.extend({},w,c);return a.each(function(){var d=g(this);d.find("."+b.listClass).find("."+b.itemClass).hide();d.data(m,s(b,b.initialScale,b.radius));for(e in t)d.bind(e+j,d,t[e])})}function x(a){var c=g(this),b=g(a.target),d=g.radmenu.container;b.hasClass(d.itemClz)||(b=b.closest("."+d.itemClz));var f=b.parents("."+d.itemClz).length>0;b=b.index();f?c.radmenu(b):c.parents("."+d.clz).radmenu(b);n(a)}function n(a){if(g.support.opacity)a.stopPropagation();else window.event.cancelBubble=
true}function s(a,c,b){return g.extend({},a,{radius:b*c})}function o(a){return parseInt(Math.random()*a)}function i(a){var c=a.data;return{menu:c,opts:c.data(m),raditems:function(){return c.find("."+g.radmenu.container.itemClz)}}}function p(a,c,b,d){if(c==b)b=c-1;var f=g(a.raditems()[c]),h=a.raditems()[b];c>b?f.insertBefore(h):f.insertAfter(h);y(a,d)}function z(a,c){var b="";a.each(function(d){var f=g(this);d=q(d+1,a.length,c);b+="<div class='"+g.radmenu.container.itemClz+"' ";b+="style='position:absolute;left:"+
d.x+"px;top:"+d.y+"px;display:none;'>";b+=f.html();b+="</div>"});return b}function q(a,c,b){var d=b.radius,f=b.angleOffset;c=2*Math.PI*parseFloat(a/c);a=b.centerX+Math.cos(c+f)*d;b=b.centerY+Math.sin(c+f)*d;return{x:a,y:b}}function y(a,c){var b=a.menu.find("."+g.radmenu.container.itemClz),d=b.length;b.each(function(f){var h=g(this),k=q(f+c,d,a.opts);h.animate({left:k.x,top:k.y},a.opts.animSpeed,f==d-1?function(){a.opts.afterAnimation(a)}:undefined)})}var j=".radmenu",m="options"+j,r="prevoptions"+
j,w={listClass:"list",itemClass:"item",activeItemClass:"active",selectEvent:null,onSelect:function(){},radius:10,initialScale:1,angleOffset:0,centerX:0,centerY:0,animSpeed:500,afterAnimation:function(){},onShow:function(a){a.show()},onHide:function(a){a.hide()},onScaleItem:function(){}};g.radmenu={container:{clz:"radial_div",itemClz:"radial_div_item",html:"<div></div>",css:{position:"relative"}}};g.fn.radmenu=function(a,c){try{var b=g(this),d=typeof a;if(arguments.length==0||d=="object")return v(b,
a);else if(d=="string")return a=="items"?b.triggerHandler(a+j):b.trigger(a+j,c||null);else if(d=="number")return b.trigger("select"+j,a)}catch(f){return"error : "+f}};var t={show:function(a,c){var b=i(a),d=g.radmenu.container;b.menu.find("."+d.clz).remove();var f=b.menu.find("."+b.opts.itemClass),h=g(d.html).addClass(d.clz).css(d.css).html(z(f,b.opts));f=h.find("."+d.itemClz);b.opts.selectEvent!=null&&f.bind(b.opts.selectEvent,x);h.appendTo(b.menu);typeof c=="function"?c(f):b.opts.onShow(f);n(a)},
hide:function(a){var c=i(a),b=c.menu.find("."+g.radmenu.container.clz);c.opts.onHide(b.find("."+g.radmenu.container.itemClz));b.remove();n(a)},select:function(a,c){var b=i(a);c=g(b.raditems().get(c));c.siblings().removeClass(b.opts.activeItemClass);c.addClass(b.opts.activeItemClass);b.opts.onSelect(c);n(a)},next:function(a){a=i(a);p(a,a.raditems().length-1,0,1)},prev:function(a){a=i(a);p(a,0,a.raditems().length-1,1)},shuffle:function(a,c){a=i(a);var b=a.raditems().length;p(a,o(b),o(b),o(c||15))},
destroy:function(a){a=i(a);a.menu.data(m,null).data(r,null).unbind(j);return a.menu},items:function(a){return i(a).raditems()},scale:function(a,c){var b=i(a);if(c){a=b.opts;var d=g.radmenu.container,f=b.menu.data(r);f||b.menu.data(r,f=a);var h=b.menu.find("."+d.itemClz),k=s(a,c,f.radius);b.menu.data(m,k);h.each(function(l){var u=g(this);l=q(l+1,h.length,k);u.css("left",l.x).css("top",l.y);b.opts.onScaleItem(u,c,l)})}return b.menu}}})(jQuery);
