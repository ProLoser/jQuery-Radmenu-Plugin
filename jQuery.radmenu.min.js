(function(e){function q(a,c){var b=e.extend({},r,c);return a.each(function(){var d=e(this);d.find("."+b.listClass).find("."+b.itemClass).hide();d.data(k,b);for(event in n)d.bind(event+h,d,n[event])})}function s(a){var c=e(this),b=e(a.target),d=e.radmenu.container;b.hasClass(d.itemClz)||(b=b.closest("."+d.itemClz));var f=b.parents("."+d.itemClz).length>0;b=b.index();f?c.radmenu(b):c.parents("."+d.clz).radmenu(b);i(a)}function i(a){if(e.support.opacity)a.stopPropagation();else window.event.cancelBubble=
true}function l(a){return parseInt(Math.random()*a)}function g(a){var c=a.data;return{menu:c,opts:c.data(k),raditems:function(){return c.find("."+e.radmenu.container.itemClz)}}}function m(a,c,b,d){if(c==b)b=c-1;var f=e(a.raditems()[c]),j=a.raditems()[b];c>b?f.insertBefore(j):f.insertAfter(j);t(a,d)}function u(a,c){var b="";a.each(function(d){var f=e(this);d=o(d+1,a.length,c);b+="<div class='"+e.radmenu.container.itemClz+"' ";b+="style='position:absolute;left:"+d.x+"px;top:"+d.y+"px;display:none;'>";
b+=f.html();b+="</div>"});return b}function o(a,c,b){var d=b.radius,f=b.angleOffset;c=2*Math.PI*parseFloat(a/c);a=b.centerX+Math.cos(c+f)*d;b=b.centerY+Math.sin(c+f)*d;return{x:a,y:b}}function t(a,c){var b=a.menu.find("."+e.radmenu.container.itemClz),d=b.length;b.each(function(f){var j=e(this),p=o(f+c,d,a.opts);j.animate({left:p.x,top:p.y},a.opts.animSpeed,f==d-1?function(){a.opts.afterAnimation(a)}:undefined)})}var k="options",h=".radmenu",r={listClass:"list",itemClass:"item",activeItemClass:"active",
selectEvent:null,onSelect:function(){},radius:10,angleOffset:0,centerX:0,centerY:0,animSpeed:500,afterAnimation:function(){},onShow:function(a){a.show()},onHide:function(a){a.hide()}};e.radmenu={container:{clz:"radial_div",itemClz:"radial_div_item",html:"<div></div>",css:{position:"relative"}}};e.fn.radmenu=function(a,c){try{var b=e(this),d=typeof a;if(arguments.length==0||d=="object")return q(b,a);else if(d=="string")return a=="items"?b.triggerHandler(a+h):b.trigger(a+h,c||null);else if(d=="number")return b.trigger("select"+
h,a)}catch(f){return"error : "+f}};var n={show:function(a){var c=g(a),b=e.radmenu.container;c.menu.find("."+b.clz).remove();var d=c.menu.find("."+c.opts.itemClass),f=e(b.html).addClass(b.clz).css(b.css).html(u(d,c.opts));d=f.find("."+b.itemClz);c.opts.selectEvent!=null&&d.bind(c.opts.selectEvent,s);f.appendTo(c.menu);typeof fn=="function"?fn(d):c.opts.onShow(d);i(a)},hide:function(a){var c=g(a),b=c.menu.find("."+e.radmenu.container.clz);c.opts.onHide(b);b.remove();i(a)},select:function(a,c){var b=
g(a);c=e(b.raditems().get(c));c.siblings().removeClass(b.opts.activeItemClass);c.addClass(b.opts.activeItemClass);b.opts.onSelect(c);i(a)},next:function(a){a=g(a);m(a,a.raditems().length-1,0,1)},prev:function(a){a=g(a);m(a,0,a.raditems().length-1,1)},shuffle:function(a,c){a=g(a);var b=a.raditems().length;m(a,l(b),l(b),l(c||15))},destroy:function(a){a=g(a);a.menu.data(k,null).unbind(h);return a.menu},items:function(a){return g(a).raditems()}}})(jQuery);
